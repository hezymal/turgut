import { FC, useEffect, useState } from "react";
import styled from "styled-components";

interface Props {
    type?: "origami";
}

const StyledMainBlock = styled.div`
    display: flex;
    justify-content: center;
    user-select: none;
`;

const StyledLabel = styled.text`
    font-size: 3em;
    font-weight: bold;
    fill: #aaa;
`;

const OrigamiSpinner: FC = () => {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="128"
            height="148"
            viewBox="0 0 388 448"
        >
            <g opacity="0">
                <rect x="189" y="194" width="8" height="190" fill="#eee" />
                <g>
                    <path
                        d="M174.045 191.921C146.738 188.869 126.119 186.565 95.374 190.065L87.5896 125.358C87.6297 125.344 87.6714 125.33 87.7147 125.316C88.2969 125.121 89.1561 124.838 90.2594 124.488C92.4662 123.789 95.6489 122.824 99.5461 121.759C107.343 119.629 117.987 117.106 129.391 115.529C140.802 113.951 152.925 113.326 163.697 114.963C174.478 116.602 183.779 120.484 189.724 127.803C199.068 139.309 200.226 155.966 198.956 169.949C198.323 176.912 197.095 183.146 196.025 187.641C195.49 189.888 194.994 191.697 194.634 192.943C194.499 193.409 194.383 193.796 194.29 194.097C187.045 193.374 180.365 192.627 174.045 191.921Z"
                        fill="#CACACA"
                    />
                    <path
                        d="M184.5 193.173C107.973 62.969 53.0132 140.158 3 203.673C65.9792 193.518 113.071 184.342 184.5 193.173Z"
                        fill="#EDEDED"
                    />
                    <path
                        d="M191.921 213.337C188.869 240.643 186.565 261.263 190.065 292.007L125.358 299.792C125.344 299.752 125.33 299.71 125.316 299.667C125.121 299.084 124.838 298.225 124.488 297.122C123.789 294.915 122.824 291.732 121.759 287.835C119.629 280.038 117.106 269.394 115.529 257.991C113.951 246.579 113.326 234.456 114.963 223.684C116.602 212.903 120.484 203.602 127.803 197.657C139.309 188.313 155.966 187.156 169.949 188.426C176.912 189.058 183.146 190.286 187.641 191.357C189.888 191.892 191.697 192.387 192.943 192.747C193.409 192.882 193.796 192.999 194.097 193.091C193.374 200.337 192.627 207.016 191.921 213.337Z"
                        fill="#CACACA"
                    />
                    <path
                        d="M193.173 202.881C62.969 279.408 140.158 334.368 203.673 384.381C193.518 321.402 184.342 274.311 193.173 202.881Z"
                        fill="#EDEDED"
                    />
                    <path
                        d="M214.337 195.752C241.643 198.803 262.263 201.108 293.007 197.608L300.792 262.315C300.752 262.329 300.71 262.343 300.667 262.357C300.084 262.552 299.225 262.835 298.122 263.184C295.915 263.883 292.732 264.849 288.835 265.914C281.038 268.044 270.394 270.567 258.991 272.144C247.579 273.722 235.456 274.347 224.684 272.71C213.903 271.071 204.602 267.189 198.657 259.87C189.313 248.364 188.156 231.707 189.426 217.724C190.058 210.761 191.286 204.527 192.357 200.032C192.892 197.785 193.387 195.976 193.747 194.73C193.882 194.264 193.999 193.877 194.091 193.576C201.337 194.299 208.016 195.046 214.337 195.752Z"
                        fill="#CACACA"
                    />
                    <path
                        d="M203.881 194.5C280.408 324.704 335.368 247.515 385.381 184C322.402 194.155 275.311 203.331 203.881 194.5Z"
                        fill="#EDEDED"
                    />
                    <path
                        d="M197.252 174.045C200.303 146.738 202.608 126.119 199.108 95.374L263.815 87.5896C263.829 87.6297 263.843 87.6714 263.857 87.7147C264.052 88.2969 264.335 89.1561 264.684 90.2594C265.383 92.4662 266.349 95.6489 267.414 99.5461C269.544 107.343 272.067 117.987 273.644 129.391C275.222 140.802 275.847 152.925 274.21 163.697C272.571 174.478 268.689 183.779 261.37 189.724C249.864 199.068 233.207 200.226 219.224 198.956C212.261 198.323 206.027 197.095 201.532 196.025C199.285 195.49 197.476 194.994 196.23 194.634C195.764 194.499 195.377 194.383 195.076 194.29C195.799 187.045 196.546 180.365 197.252 174.045Z"
                        fill="#CACACA"
                    />
                    <path
                        d="M196 184.5C326.204 107.973 249.015 53.0132 185.5 3C195.655 65.9792 204.831 113.071 196 184.5Z"
                        fill="#EDEDED"
                    />
                    <path
                        d="M183.901 205.113C182.923 196.724 183.101 191.603 183.916 182.928C184.038 182.918 184.16 182.908 184.281 182.898C192.977 182.183 198.21 181.752 206.052 182.871C206.566 191.306 206.556 196.437 206.05 205.125C197.266 206.354 192.214 206.221 183.901 205.113Z"
                        fill="#CACACA"
                    />
                    <circle cx="194" cy="194" r="5" fill="white" />
                    <animateTransform
                        attributeName="transform"
                        type="rotate"
                        from="0 194 194"
                        to="360 194 194"
                        dur="3s"
                        repeatCount="indefinite"
                    />
                </g>
                <StyledLabel x="110" y="440">
                    Loading...
                </StyledLabel>
                <animate
                    attributeType="XML"
                    attributeName="opacity"
                    values="0;1"
                    dur="1s"
                    fill="freeze"
                />
            </g>
        </svg>
    );
};

export const Spinner: FC<Props> = ({ type = "origami" }) => {
    const [visible, setVisible] = useState(false);

    useEffect(() => {
        const timeoutId = setTimeout(() => setVisible(true), 1000);
        return () => {
            clearTimeout(timeoutId);
        };
    }, []);

    if (visible) {
        if (type === "origami") {
            return (
                <StyledMainBlock>
                    <OrigamiSpinner />
                </StyledMainBlock>
            );
        }
    }

    return null;
};
